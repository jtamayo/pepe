Measurement collector tool
--------------------------

This directory contains the necessary patches to build the measurement
collector that produced the benchmark statistics in the paper, tech report 
and web pages.

To build the collector,

- download and unpack JikesRVM 2.4.6 from jikesrvm.sourceforge.net.
        cd jikesrvm-2.4.6
        patch -p0 <measure/01-dynamicscope.patch
        patch -p0 <measure/02-xmlstats.patch
        patch -p0 <measure/03-measurement.patch

        # set RVM_ROOT, RVM_BUILD, RVM_HOST_CONFIG and PATH as documented
        # in the JikesRVM user manual

        jconfigure FastAdaptiveMeasurement
        (cd $RVM_BUILD; ./jbuild)

- To run a benchmark through the collector

	rvm -X:gc:stressFactor=<interval> \
            -X:gc:cohortSize=<cohort-size> \
            -X:gc:xmlStats=true \
            -jar dacapo-2006-10.jar -c MMTkCallback <bm>

If running a non-dacapo benchmark, you need to arrange for the MMTk Harness
to be called to start and stop statistic collection.  The command line option

        -X:gc:harnessWholeRun=true

will collect statistics for the whole program run.


Some of the statistics in the paper are generated by collecting survival rates
of objects in a fixed size 4MB nursery.  To collect these stats, start with a 
fresh version of JikesRVM 2.4.6, and
	cd jikesrvm-2.4.6
        patch -p0 <markcons/01-xmlstats.patch
        patch -p0 <markcons/02-markcons.patch

        # set RVM_ROOT, RVM_BUILD, RVM_HOST_CONFIG and PATH as documented
        # in the JikesRVM user manual

        jconfigure FastAdaptiveGenMS
        (cd $RVM_BUILD; ./jbuild)

Then run

	rvm -X:gc:fixedNursery=4m \
            -X:gc:xmlStats=true \     # Optional
	    -jar dacapo-2006-10.jar -c MMTkCallback <bm>
